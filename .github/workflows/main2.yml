name: Test Personal ACR

on: [push]

jobs:
  test:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Test Login to Personal ACR
      env:
        ACR_INSTANCE: crpi-30m5pxt0p5qxy6sk.cn-hangzhou.personal.cr.aliyuncs.com
        ACR_USERNAME: ${{ secrets.ALIYUN_USERNAME }}
        ACR_PASSWORD: ${{ secrets.ALIYUN_PASSWORD }}
      run: |
        echo "测试登录到: $ACR_INSTANCE"
        
        if echo "$ACR_PASSWORD" | docker login \
          --username "$ACR_USERNAME" \
          --password-stdin \
          "$ACR_INSTANCE"; then
          echo "✅ 登录成功！"
          echo "实例地址正确: $ACR_INSTANCE"
        else
          echo "❌ 登录失败"
          echo "请检查："
          echo "1. 实例地址是否正确"
          echo "2. 用户名密码是否正确"
          exit 1
        fi
